The ssh program is designed to replace older, less secure terminal applications used to log in to remote hosts, such as telnet or rsh. A related program called scp replaces older programs designed to copy files between hosts, such as rcp. 
Because these older applications do not encrypt passwords transmitted between the client and the server, avoid them whenever possible. Using secure methods to log in to remote systems decreases the risks for both the client system and the remote host.



Two varieties of SSH currently exist: version 1, and newer version 2. The OpenSSH suite under Red Hat Enterprise Linux 7 uses SSH version 2, which has an enhanced key exchange algorithm not vulnerable to the known exploit in version 1. In Red Hat Enterprise Linux 7, the OpenSSH suite does not support version 1 connections.




Transport Layer
The primary role of the transport layer is to facilitate safe and secure communication between the two hosts at the time of authentication and during subsequent communication. The transport layer accomplishes this by handling the encryption and decryption of data, and by providing integrity protection of data packets as they are sent and received. The transport layer also provides compression, speeding the transfer of information.
Once an SSH client contacts a server, key information is exchanged so that the two systems can correctly construct the transport layer. The following steps occur during this exchange:


Keys are exchanged
The public key encryption algorithm is determined
The symmetric encryption algorithm is determined
The message authentication algorithm is determined
The hash algorithm is determined


During the key exchange, the server identifies itself to the client with a unique host key. If the client has never communicated with this particular server before, the server’s host key is unknown to the client and it does not connect. OpenSSH gets around this problem by accepting the server’s host key. This is done after the user is notified and has both accepted and verified the new host key. In subsequent connections, the server’s host key is checked against the saved version on the client, providing confidence that the client is indeed communicating with the intended server. If, in the future, the host key no longer matches, the user must remove the client’s saved version before a connection can occur.



SSH is designed to work with almost any kind of public key algorithm or encoding format. After an initial key exchange creates a hash value used for exchanges and a shared secret value, the two systems immediately begin calculating new keys and algorithms to protect authentication and future data sent over the connection.
After a certain amount of data has been transmitted using a given key and algorithm (the exact amount depends on the SSH implementation), another key exchange occurs, generating another set of hash values and a new shared secret value. Even if an attacker is able to determine the hash and shared secret value, this information is only useful for a limited period of time.















apt update
apt install -y openssh-server
ssh -V

systemctl restart sshd.service
systemctl restart sshd


systemctl restart ssh.service

systemctl status sshd.service
systemctl status sshd



/etc/ssh/sshd_config

PermitRootLogin yes
#PasswordAuthentication yes








~/.ssh/known_hosts

Stores the fingerprints (host keys) of servers you have connected to before, to prevent man-in-the-middle attacks



~/.ssh/authorized_keys

Defines which clients are allowed to log in to this server without a password, using SSH public key authentication.



ssh-copy-id alice@server1

What happens:

It appends the content of id_rsa.pub to server1:~/.ssh/authorized_keys











SSH consists of three distinct layers:

The transport layer
The authentication layer
The connection layer




The two most common SSH user authentication methods used are passwords and SSH keys.



SSH uses three data encryption types during the communication between the machines. These are:
Symmetric encryption
Asymmetric encryption
Hashing






Hashing algorithms used to produce hashes in SSH are Message Authentication Code (MAC) and Hashed Message Authentication Code (HMAC)







ssh username@host

ssh 'username@email'@host









create a pair of two keys consisting of a public and a private key

ssh-keygen


~/.ssh/id_rsa.pub - public key
~/.ssh/id_rsa - private key


# file *
id_rsa:     OpenSSH private key
id_rsa.pub: OpenSSH RSA public key
#



The public key does not need to be secret. It is used to verify the private key. The private key is secret.

Copy the most recently modified public key to a remote machine you want to log into:
ssh-copy-id username@localhost

