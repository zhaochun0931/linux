docker compose up



ðŸš€ open one terminal
docker exec -it myalpine1 sh


ðŸš€ the ping command should work
ping -c 3 myalpine2
ping -c 3 myalpine3











ðŸš€ open another terminal

docker exec -it myalpine2 sh



iptables -L


ðŸš€ Option 1: Drop pings silently (no reply)


iptables -A INPUT -p icmp --icmp-type echo-request -j DROP


The system will ignore incoming pings.
From the senderâ€™s side, it looks like the host is unreachable (no reply at all).



/ # tcpdump -i any icmp
tcpdump: WARNING: any: That device doesn't support promiscuous mode
(Promiscuous mode not supported on the "any" device)
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes
12:21:22.875302 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 110, length 64
12:21:22.875345 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP echo reply, id 31, seq 110, length 64
12:21:23.875772 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 111, length 64
12:21:23.875825 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP echo reply, id 31, seq 111, length 64
12:21:24.876669 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 112, length 64
12:21:25.877443 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 113, length 64
12:21:26.879037 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 114, length 64
12:21:27.879375 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 115, length 64
12:21:28.880408 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 116, length 64
12:21:29.881393 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 117, length 64
12:21:30.882898 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 118, length 64
12:21:31.884574 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 119, length 64









ðŸš€ Option 2: Reject pings politely (send an error back)
iptables -A INPUT -p icmp --icmp-type echo-request -j REJECT


The system replies with â€œICMP Destination Unreachableâ€.

The sender knows the ping was explicitly rejected.



tcpdump -i any icmp



/ # tcpdump -i any icmp
tcpdump: WARNING: any: That device doesn't support promiscuous mode
(Promiscuous mode not supported on the "any" device)
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes
12:19:32.660944 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 0, length 64
12:19:32.661033 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 11166 unreachable, length 92
12:19:33.663399 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 1, length 64
12:19:33.663484 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 22610 unreachable, length 92
12:19:34.664741 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 2, length 64
12:19:34.664854 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 55816 unreachable, length 92
12:19:35.669831 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 3, length 64
12:19:35.669915 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 38321 unreachable, length 92
12:19:36.671239 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 4, length 64
12:19:36.671415 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 56680 unreachable, length 92
12:19:37.671893 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 5, length 64
12:19:37.672006 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 61986 unreachable, length 92
12:19:38.672728 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 6, length 64
12:19:38.672837 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 23772 unreachable, length 92
12:19:39.674048 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 7, length 64
12:19:39.674132 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 58259 unreachable, length 92
12:19:40.680357 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 8, length 64
12:19:40.680438 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 60215 unreachable, length 92
12:19:41.680948 eth0  Out IP myalpine1 > myalpine2.iptable-load-balance_demo-network: ICMP echo request, id 31, seq 9, length 64
12:19:41.681065 eth0  In  IP myalpine2.iptable-load-balance_demo-network > myalpine1: ICMP myalpine2.iptable-load-balance_demo-network protocol 1 port 23282 unreachable, length 92










Chain INPUT (policy ACCEPT)
target     prot opt source               destination
REJECT     icmp --  anywhere             anywhere             icmp echo-request reject-with icmp-port-unreachable

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
