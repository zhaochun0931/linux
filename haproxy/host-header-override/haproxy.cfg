global
    log stdout format raw local0
    maxconn 4096

defaults
    log global
    mode http
    option httplog
    timeout connect 5s
    timeout client 30s
    timeout server 30s

frontend http_front
    bind *:80

    # ACLs based on incoming host
    acl host_web1 hdr(host) -i app1.local
    acl host_web2 hdr(host) -i app2.local

    # Route based on ACL
    use_backend backend_web1 if host_web1
    use_backend backend_web2 if host_web2

backend backend_web1
    mode http
    http-request set-header Host web1.internal.local
    server web1 web1:80 check

backend backend_web2
    mode http
    http-request set-header Host web2.internal.local
    server web2 web2:80 check

