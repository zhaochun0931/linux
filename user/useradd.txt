✅ useradd → low-level, script-friendly, minimal.
✅ adduser → high-level, human-friendly, interactive wrapper.



Each user is associated with a unique numerical identification number called a user ID (UID). Likewise, each group is associated with a group ID (GID).

the shadow passwords provided by the shadow-utils package to enhance the security of system authentication files


/etc/passwd

/etc/shadow



✅ Step 1: Read configuration defaults
Before doing anything, useradd reads:

/etc/login.defs → default UID/GID ranges, home dir base, password aging

/etc/default/useradd → default shell, home directory policy, skeleton path


✅ Step 2: Choose UID, GID, and group

useradd finds the next available UID (usually ≥ 1000 for normal users).

Then it:

Creates a new group with the same name (unless -N is used)

Adds an entry to /etc/group and /etc/gshadow


✅ Step 3: Add entry to /etc/passwd

A new line is added to /etc/passwd:

alice:x:1001:1001::/home/alice:/bin/bash


✅ Step 4: Add entry to /etc/shadow

A locked password entry is added:

alice:!:19888:0:99999:7:::


! means the account is locked until a password is set via passwd.


✅ Step 5: Create home directory (if -m specified)

If you use -m:

Creates /home/alice

Copies files from /etc/skel (default skeleton directory)

Sets ownership:

chown alice:alice /home/alice
chmod 700 /home/alice


If you omit -m, the user exists but has no home directory.


✅  Step 6: (Optional) Create mail spool

If CREATE_MAIL_SPOOL=yes in /etc/login.defs, it creates /var/mail/alice.




✅ Step 7: Apply shell and expiration settings

If you specify:

-s /bin/bash → sets login shell

-e or -f → sets account expiration date

-c → adds a comment (e.g. “Alice Smith”)












useradd user1


✅ By default, the useradd command creates a locked user account. To unlock the account, run the following command as root to assign a password:

passwd username



passwd --status xiaoming1
passwd -S xiaoming1



# passwd --status xiaoming1
xiaoming1 LK 2025-11-05 0 99999 7 -1 (Password locked.)
#
#
# passwd --status xiaoming2
xiaoming2 LK 2025-11-05 0 99999 7 -1 (Password locked.)
# passwd -S xiaoming1
xiaoming1 LK 2025-11-05 0 99999 7 -1 (Password locked.)
#







✅ Check /etc/shadow

sudo grep "^username:" /etc/shadow


testuser:!$6$XyP...:19888:0:99999:7:::


Explanation of the second field:

If it starts with ! or *, the account is locked.

If it’s a valid hash (e.g., $6$...), it’s active.




# su - user1
su: warning: cannot change directory to /home/xiaoming: No such file or directory
xiaoming@gf1:/root$






# -m Create the user's home directory if it does not exist. 

useradd -m user2



# -s specifies the user’s shell

useradd -m -s /bin/bash user3








useradd is a low-level utility that directly interfaces with system configuration files.  It performs minimal setup by creating a new user account but does not handle some of the additional setup tasks by default. After creating the account with useradd, you might need to run additional commands to set a password 
