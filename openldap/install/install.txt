apt update

apt install slapd ldap-utils -y


During installation, you will be prompted for an Administrator password. This sets the password for the admin account of your LDAP directory.




Configuring slapd
-----------------

Please enter the password for the admin entry in your LDAP directory.

Administrator password:

Please enter the admin password for your LDAP directory again to verify that you have typed it correctly.

Confirm password:








âœ… check openladap service
systemctl status slapd.service



# systemctl status slapd.service
â— slapd.service - LSB: OpenLDAP standalone server (Lightweight Directory Access Protocol)
     Loaded: loaded (/etc/init.d/slapd; generated)
    Drop-In: /usr/lib/systemd/system/slapd.service.d
             â””â”€slapd-remain-after-exit.conf
     Active: active (running) since Mon 2025-11-24 10:19:30 UTC; 1min 9s ago
       Docs: man:systemd-sysv-generator(8)
    Process: 2371 ExecStart=/etc/init.d/slapd start (code=exited, status=0/SUCCESS)
      Tasks: 3 (limit: 978)
     Memory: 5.2M (peak: 5.5M)
        CPU: 34ms
     CGroup: /system.slice/slapd.service
             â””â”€2378 /usr/sbin/slapd -h "ldap:/// ldapi:///" -g openldap -u openldap -F /etc/ldap/slapd.d

Nov 24 10:19:29 test systemd[1]: Starting slapd.service - LSB: OpenLDAP standalone server (Lightweight Directory Acces>
Nov 24 10:19:30 test slapd[2371]:  * Starting OpenLDAP slapd
Nov 24 10:19:30 test slapd[2377]: @(#) $OpenLDAP: slapd 2.6.7+dfsg-1~exp1ubuntu8.2 (Dec  9 2024 02:50:18) $
                                          Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Nov 24 10:19:30 test slapd[2378]: slapd starting
Nov 24 10:19:30 test slapd[2371]:    ...done.
Nov 24 10:19:30 test systemd[1]: Started slapd.service - LSB: OpenLDAP standalone server (Lightweight Directory Access>
#




slapd -V




# slapd -V
@(#) $OpenLDAP: slapd 2.6.7+dfsg-1~exp1ubuntu8.2 (Dec  9 2024 02:50:18) $
	Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>

#




âœ… install successfully




âœ…

2. Initial Configuration (The Easy Way)
On Debian-based systems, you can trigger a guided setup that handles the heavy lifting of the cn=config setup for you.


sudo dpkg-reconfigure slapd



Follow these prompts:

Omit OpenLDAP server configuration? No.

DNS domain name: Enter your domain (e.g., office.example.com). This creates your Base DN (e.g., dc=office,dc=example,dc=com).

Organization name: Your company or project name.

Administrator password: Enter the admin password again.

Database backend: Select MDB (the modern standard).

Remove database when slapd is purged? No (usually).

Move old database? Yes.






3. Understanding the Hierarchy
LDAP stores data in a tree structure (the DIT). To manage it, you need to understand the components.

dn (Distinguished Name): The unique path to an entry (like a full file path).

dc (Domain Component): Parts of your domain (e.g., dc=example,dc=com).

ou (Organizational Unit): Like a folder (e.g., ou=Users).

cn (Common Name): The name of the specific object (e.g., cn=John Doe).




4. Adding Data (LDIF Files)
In the OLC era, you don't edit config files directly. Instead, you create .ldif files and "inject" them into the server.

Create a file called base.ldif:






Import the file:
Use the ldapadd command. You will need the admin password you created earlier.


ldapadd -x -D "cn=admin,dc=example,dc=com" -W -f base.ldif






5. Verify the Configuration

To see if your entries were added correctly, run a search:


ldapsearch -x -b "dc=example,dc=com" "(objectClass=*)"







âœ…

To create a user account in OpenLDAP, you need to define it in an LDIF (LDAP Data Interchange Format) file. This file tells the server which "Object Classes" to use and which attributes (like name, UID, and password) to assign.

1. Generate a Hashed Password
For security, you should never store passwords in plain text. Use the slappasswd utility to generate a hashed version:


slappasswd
Input: Your desired user password.

Output: Something like {SSHA}6jG+K0H... (Copy this string).


# slappasswd
New password:
Re-enter new password:
{SSHA}FlmpNy1U+3Es1+Zic6fysSsGCrQpI2pB
#







2. Create the LDIF File
Create a file named newuser.ldif. We will use the inetOrgPerson object class, which is the standard for people, and posixAccount if you want the user to be able to log in to Linux systems.





Key Attribute Breakdown:
dn: The "Distinguished Name"â€”the unique address for this user.

uid: The username (unique identifier).

uidNumber / gidNumber: These must be unique on your system (typically start above 10000 to avoid system conflicts).

homeDirectory: The path to the user's home folder.

userPassword: The hash you generated in Step 1.

3. Add the User to OpenLDAP
Run the following command to inject the user into your directory. Replace the -D path with your actual admin DN.


ldapadd -x -D "cn=admin,dc=example,dc=com" -W -f newuser.ldif


-x: Use simple authentication.

-D: The Bind DN (the admin account authorized to add users).

-W: Prompt for the admin password.

-f: The path to your LDIF file.

4. Verify the New User
To ensure the user was created correctly, search for them by their UID:


ldapsearch -x -b "dc=example,dc=com" "uid=user01"











âœ…

To test if your new LDAP user is actually working, you should verify two things: that the user is searchable and that the user can authenticate (bind) with their own password.

1. The Search Test
First, confirm the entry exists and is readable. Youâ€™ve likely already used a similar command, but this specifically targets the new user's UID to ensure the attributes are correct.



ldapsearch -x -b "dc=example,dc=com" "(uid=user01)"
Success: You see the full LDIF output for user01.


root@openldap:~# ldapsearch -x -b "dc=example,dc=com" "(uid=user01)"
# extended LDIF
#
# LDAPv3
# base <dc=example,dc=com> with scope subtree
# filter: (uid=user01)
# requesting: ALL
#

# user01, People, example.com
dn: uid=user01,ou=People,dc=example,dc=com
objectClass: top
objectClass: account
objectClass: posixAccount
objectClass: shadowAccount
cn: user01
uid: user01
loginShell: /bin/bash
uidNumber: 10001
gidNumber: 10001
homeDirectory: /home/user01
gecos: user01

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
#




Failure: You get numResponses: 1 (just the search result) but no data, or an error. This usually means your Base DN (-b) is wrong or the user wasn't added.

2. The Authentication Test (The "Bind" Test)

This is the most important test. It verifies that the password you hashed actually works. You will attempt to "bind" to the LDAP server as the user rather than as the admin.



ldapwhoami -x -D "uid=user01,ou=People,dc=example,dc=com" -W

ldapwhoami -x -D "uid=user01,ou=People,dc=example,dc=com" -w 'password'

ldapwhoami -x -H ldap://localhost:389 -D "uid=user01,ou=People,dc=example,dc=com" -w 'password'




# ldapwhoami -x -D "uid=user01,ou=People,dc=example,dc=com" -W
Enter LDAP Password:
dn:uid=user01,ou=People,dc=example,dc=com
#


-D: This is the "Bind DN"â€”the specific path to the user you are testing.

-W: This will prompt you for John Doe's password (the plain text version of the hash you created).

Expected Success Output: dn:uid=jdoe,ou=People,dc=example,dc=com

If it fails: You will see ldap_bind: Invalid credentials (49). This means the password hash in your LDIF doesn't match what you're typing.



3. Testing with ldapsearch (as the User)
To be 100% sure the user has the right permissions to see the directory, try a search while logged in as that user:


ldapsearch -x -D "uid=user01,ou=People,dc=example,dc=com" -W -b "dc=example,dc=com" "(cn=*)"


# ldapsearch -x -D "uid=user01,ou=People,dc=example,dc=com" -W -b "dc=example,dc=com" "(cn=*)"
Enter LDAP Password:
# extended LDIF
#
# LDAPv3
# base <dc=example,dc=com> with scope subtree
# filter: (cn=*)
# requesting: ALL
#

# user01, People, example.com
dn: uid=user01,ou=People,dc=example,dc=com
objectClass: top
objectClass: account
objectClass: posixAccount
objectClass: shadowAccount
cn: user01
uid: user01
loginShell: /bin/bash
uidNumber: 10001
gidNumber: 10001
homeDirectory: /home/user01
userPassword:: e1NTSEF9RmxtcE55MVUrM0VzMStaaWM2ZnlzU3NHQ3JRcEkycEI=
gecos: user01

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
root@openldap:~#




ðŸš€ 5. Test anonymous search (optional)
âœ… 1. List ALL entries in your LDAP (full tree)

ldapsearch -x -H ldap://localhost:389 -b "dc=example,dc=com"

ldapsearch -x -H ldap://localhost:389 -D "cn=admin,dc=example,dc=com" -b "dc=example,dc=com" -w 'password' 

ldapsearch -x -H ldap://localhost:389 -D "cn=admin,dc=example,dc=com" -b "dc=example,dc=com" -W



âœ… 2. List only users (posixAccount)

ldapsearch -x -H ldap://localhost:389 -D "cn=admin,dc=example,dc=com"  -b "dc=example,dc=com" "(objectClass=posixAccount)" uid cn dn -w 'password'

ldapsearch -x -H ldap://localhost:389 -D "cn=admin,dc=example,dc=com"  -b "dc=example,dc=com" "(objectClass=posixAccount)" -w 'password'


ldapsearch -x -H ldap://localhost:389 -D "cn=admin,dc=example,dc=com" -b "ou=people,dc=example,dc=com" "(objectClass=*)" -W
