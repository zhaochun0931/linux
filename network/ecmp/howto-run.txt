docker exec router1 sysctl -w net.ipv4.ip_forward=1
docker exec router2 sysctl -w net.ipv4.ip_forward=1



docker exec router1 sysctl net.ipv4.ip_forward

  
  

  
✅
docker exec -it client bash

apt-get update && apt-get install -y iproute2 iputils-ping traceroute net-tools


ip route del default

ip route add default \
  nexthop via 10.0.1.2 weight 1 \
  nexthop via 10.0.1.3 weight 1


ip route show






✅
docker exec -it server bash

apt-get update && apt-get install -y iproute2 iputils-ping traceroute net-tools netcat

ip route del default


ip route add default \
  nexthop via 10.0.2.2 weight 1 \
  nexthop via 10.0.2.3 weight 1


ip route show




arp



ip route replace default \
  nexthop via 10.0.1.2 weight 1



ip route replace default \
  nexthop via 10.0.1.3 weight 1







Linux can do per-packet ECMP, but it is not recommended:

sysctl -w net.ipv4.fib_multipath_hash_policy=1
sysctl -w net.ipv4.fib_multipath_use_neigh=1


