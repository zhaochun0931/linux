apt install cgroup-tools -y



ðŸ§° 3. Example for cgroup v2


stat -fc %T /sys/fs/cgroup/

# stat -fc %T /sys/fs/cgroup/
cgroup2fs
#



# Create a test cgroup

cgcreate -g cpu:/testgroup

tree /sys/fs/cgroup/testgroup



/sys/fs/cgroup/testgroup
â”œâ”€â”€ cgroup.controllers
â”œâ”€â”€ cgroup.events
â”œâ”€â”€ cgroup.freeze
â”œâ”€â”€ cgroup.kill
â”œâ”€â”€ cgroup.max.depth
â”œâ”€â”€ cgroup.max.descendants
â”œâ”€â”€ cgroup.pressure
â”œâ”€â”€ cgroup.procs
â”œâ”€â”€ cgroup.stat
â”œâ”€â”€ cgroup.subtree_control
â”œâ”€â”€ cgroup.threads
â”œâ”€â”€ cgroup.type
â”œâ”€â”€ cpu.idle
â”œâ”€â”€ cpu.max
â”œâ”€â”€ cpu.max.burst
â”œâ”€â”€ cpu.pressure
â”œâ”€â”€ cpuset.cpus
â”œâ”€â”€ cpuset.cpus.effective
â”œâ”€â”€ cpuset.cpus.exclusive
â”œâ”€â”€ cpuset.cpus.exclusive.effective
â”œâ”€â”€ cpuset.cpus.partition
â”œâ”€â”€ cpuset.mems
â”œâ”€â”€ cpuset.mems.effective
â”œâ”€â”€ cpu.stat
â”œâ”€â”€ cpu.stat.local
â”œâ”€â”€ cpu.uclamp.max
â”œâ”€â”€ cpu.uclamp.min
â”œâ”€â”€ cpu.weight
â”œâ”€â”€ cpu.weight.nice
â”œâ”€â”€ io.max
â”œâ”€â”€ io.pressure
â”œâ”€â”€ io.prio.class
â”œâ”€â”€ io.stat
â”œâ”€â”€ io.weight
â”œâ”€â”€ memory.current
â”œâ”€â”€ memory.events
â”œâ”€â”€ memory.events.local
â”œâ”€â”€ memory.high
â”œâ”€â”€ memory.low
â”œâ”€â”€ memory.max
â”œâ”€â”€ memory.min
â”œâ”€â”€ memory.numa_stat
â”œâ”€â”€ memory.oom.group
â”œâ”€â”€ memory.peak
â”œâ”€â”€ memory.pressure
â”œâ”€â”€ memory.reclaim
â”œâ”€â”€ memory.stat
â”œâ”€â”€ memory.swap.current
â”œâ”€â”€ memory.swap.events
â”œâ”€â”€ memory.swap.high
â”œâ”€â”€ memory.swap.max
â”œâ”€â”€ memory.swap.peak
â”œâ”€â”€ memory.zswap.current
â”œâ”€â”€ memory.zswap.max
â”œâ”€â”€ memory.zswap.writeback
â”œâ”€â”€ pids.current
â”œâ”€â”€ pids.events
â”œâ”€â”€ pids.max
â””â”€â”€ pids.peak



# Set CPU limit (format: <max> <period>)
# 20000/100000 = 20% CPU limit
echo "20000 100000" | sudo tee /sys/fs/cgroup/testgroup/cpu.max




# Add a process into the cgroup
echo $$ | sudo tee /sys/fs/cgroup/testgroup/cgroup.procs


âœ… Now the shell process (your current terminal) is limited to 20% CPU usage.

You can test it:

yes > /dev/null &
top


Youâ€™ll see it capped around 20% CPU.


